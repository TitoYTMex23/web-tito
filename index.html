<script src="games.js"></script> <script>
    // Inicializar Telegram
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    const container = document.getElementById('games-container');
    const loading = document.getElementById('loading');

    // Renderizar juegos (Versión optimizada)
    function renderGames() {
        if (loading) loading.style.display = 'none';
        
        // Cargamos solo los primeros 100 para probar rápido
        const juegosMostrados = typeof DATABASE_JUEGOS !== 'undefined' ? DATABASE_JUEGOS.slice(0, 100) : [];

        if (juegosMostrados.length === 0) {
            container.innerHTML = "<p style='color:white; text-align:center;'>Error: No se cargó games.js</p>";
            return;
        }

        juegosMostrados.forEach(game => {
            const card = document.createElement('div');
            card.className = 'game-card';
            // Usamos un onclick directo y sencillo
            card.innerHTML = `
                <img src="${game.imagen}" onerror="this.src='https://via.placeholder.com/150?text=No+Img'">
                <div class="game-info">
                    <h3>${game.titulo}</h3>
                    <button class="download-btn" onclick="enviarAlBot('${game.comando}')">
                        DESCARGAR
                    </button>
                </div>
            `;
            container.appendChild(card);
        });
    }

    // Función del Botón con "Chivato"
    function enviarAlBot(comando) {
        // 1. Alerta visual en el celular
        alert("Enviando: " + comando); 
        
        // 2. Enviar a Telegram
        try {
            tg.sendData(comando);
            // No cerramos la web inmediatamente para que veas si sale el error
        } catch (e) {
            alert("Error enviando: " + e);
        }
    }

    // Arrancar
    document.addEventListener('DOMContentLoaded', renderGames);
</script>
